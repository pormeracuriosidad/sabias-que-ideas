<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí° Banco de Ideas - "Sab√≠as qu√©..." - Blog Cient√≠fico</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 16px;
            opacity: 0.95;
            margin-bottom: 20px;
        }

        .sync-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
        }

        .sync-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ade80;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .stats {
            display: flex;
            justify-content: space-around;
            padding: 30px 20px;
            background: #f7fafc;
            border-bottom: 2px solid #e2e8f0;
            flex-wrap: wrap;
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            flex: 1;
            min-width: 150px;
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 13px;
            color: #718096;
            text-transform: uppercase;
            margin-top: 5px;
            letter-spacing: 0.5px;
        }

        .add-section {
            padding: 30px;
            background: white;
            border-bottom: 2px solid #e2e8f0;
        }

        .add-section h2 {
            font-size: 20px;
            color: #2d3748;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 8px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.2s;
            font-family: inherit;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .char-counter {
            text-align: right;
            font-size: 12px;
            color: #718096;
            margin-top: 5px;
        }

        .scientific-section {
            margin: 25px 0;
            padding: 20px;
            background: #eef2ff;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .scientific-section h3 {
            font-size: 16px;
            color: #3730a3;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .image-section {
            margin: 25px 0;
            padding: 20px;
            background: #f0fdf4;
            border-radius: 12px;
            border-left: 4px solid #10b981;
        }

        .image-section h3 {
            font-size: 16px;
            color: #065f46;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            flex: 1;
            min-width: 150px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-secondary:hover {
            background: #f7fafc;
        }

        .filters {
            padding: 20px 30px;
            background: #fafafa;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
            border-bottom: 2px solid #e2e8f0;
        }

        .filter-label {
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
        }

        .filter-select {
            padding: 8px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
            padding: 10px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
        }

        .ideas-container {
            padding: 30px;
            max-height: 600px;
            overflow-y: auto;
        }

        .idea-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.2s;
            display: flex;
            gap: 15px;
        }

        .idea-card:hover {
            border-color: #cbd5e0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .idea-card.completed {
            background: #f0fff4;
            border-color: #9ae6b4;
        }

        .checkbox-wrapper {
            flex-shrink: 0;
        }

        .checkbox-wrapper input[type="checkbox"] {
            width: 24px;
            height: 24px;
            cursor: pointer;
            accent-color: #667eea;
        }

        .idea-content {
            flex: 1;
        }

        .idea-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
            gap: 15px;
        }

        .idea-category {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .cat-nutricion { background: #fef3c7; color: #92400e; }
        .cat-celular { background: #dbeafe; color: #1e40af; }
        .cat-genetica { background: #e0e7ff; color: #3730a3; }
        .cat-metabolismo { background: #fce7f3; color: #9f1239; }
        .cat-inmunologia { background: #d1fae5; color: #065f46; }
        .cat-neurociencia { background: #e9d5ff; color: #6b21a8; }
        .cat-general { background: #f3f4f6; color: #374151; }

        .idea-title {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .idea-explanation {
            font-size: 14px;
            color: #4a5568;
            line-height: 1.7;
            margin-bottom: 12px;
            padding: 12px;
            background: #f7fafc;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }

        .idea-reference {
            font-size: 13px;
            color: #718096;
            font-style: italic;
            padding: 10px;
            background: #fffbeb;
            border-radius: 6px;
            margin-bottom: 12px;
            border-left: 3px solid #f59e0b;
        }

        .idea-reference strong {
            color: #92400e;
            font-style: normal;
        }

        .idea-question {
            font-size: 15px;
            color: #059669;
            font-weight: 500;
            margin-bottom: 10px;
        }

        .idea-image-section {
            margin-top: 15px;
            padding: 15px;
            background: #f0fdf4;
            border-radius: 8px;
            border-left: 4px solid #10b981;
        }

        .idea-image-section h4 {
            font-size: 13px;
            color: #065f46;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .idea-image-preview {
            max-width: 100%;
            border-radius: 8px;
            margin-top: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .idea-image-url {
            font-size: 12px;
            color: #059669;
            word-break: break-all;
            margin: 5px 0;
        }

        .idea-image-url a {
            color: #059669;
            text-decoration: none;
        }

        .idea-image-url a:hover {
            text-decoration: underline;
        }

        .idea-prompt {
            font-size: 12px;
            color: #4a5568;
            background: white;
            padding: 10px;
            border-radius: 6px;
            margin: 8px 0;
            font-family: 'Courier New', monospace;
            line-height: 1.5;
        }

        .idea-meta {
            display: flex;
            gap: 20px;
            font-size: 12px;
            color: #718096;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .idea-actions {
            display: flex;
            gap: 10px;
            flex-shrink: 0;
        }

        .btn-icon {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 16px;
        }

        .btn-edit {
            background: #edf2f7;
            color: #4a5568;
        }

        .btn-edit:hover {
            background: #e2e8f0;
        }

        .btn-delete {
            background: #fed7d7;
            color: #c53030;
        }

        .btn-delete:hover {
            background: #fc8181;
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #718096;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 20px;
            color: #4a5568;
            margin-bottom: 10px;
        }

        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #2d3748;
            color: white;
            padding: 16px 24px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast.show {
            display: flex;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            max-width: 500px;
            width: 100%;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            font-size: 22px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 24px; }
            .stats { flex-direction: column; }
            .btn-container { flex-direction: column; }
            .idea-card { flex-direction: column; }
            .idea-actions { flex-direction: row; }
            .filters { flex-direction: column; align-items: stretch; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí° Banco de Ideas "Sab√≠as qu√©..."</h1>
            <p>Ideas cient√≠ficas con explicaci√≥n y referencias acad√©micas</p>
            <div class="sync-status">
                <div class="sync-indicator"></div>
                <span>Guardado local autom√°tico</span>
            </div>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="totalIdeas">0</div>
                <div class="stat-label">Total de Ideas</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="completedIdeas">0</div>
                <div class="stat-label">Publicadas</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="pendingIdeas">0</div>
                <div class="stat-label">Pendientes</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="progressPercent">0%</div>
                <div class="stat-label">Progreso</div>
            </div>
        </div>

        <div class="add-section">
            <h2>‚ûï Agregar Nueva Idea</h2>
            <form id="ideaForm">
                <div class="form-group">
                    <label for="ideaTitle">üí≠ "Sab√≠as qu√©..." (La pregunta)*</label>
                    <input type="text" id="ideaTitle" placeholder='Ej: ¬øSab√≠as que los gl√≥bulos rojos no tienen n√∫cleo ni mitocondrias?' required maxlength="200">
                    <div class="char-counter"><span id="titleCounter">0</span>/200</div>
                </div>

                <div class="form-group">
                    <label for="ideaCategory">üî¨ Categor√≠a*</label>
                    <select id="ideaCategory" required>
                        <option value="">Selecciona una categor√≠a</option>
                        <option value="celular">Biolog√≠a Celular y Molecular</option>
                        <option value="genetica">Gen√©tica</option>
                        <option value="metabolismo">Metabolismo</option>
                        <option value="inmunologia">Inmunolog√≠a</option>
                        <option value="neurociencia">Neurociencia</option>
                        <option value="nutricion">Nutrici√≥n</option>
                        <option value="general">General</option>
                    </select>
                </div>

                <!-- Secci√≥n Cient√≠fica -->
                <div class="scientific-section">
                    <h3>üî¨ Contenido Cient√≠fico</h3>

                    <div class="form-group">
                        <label for="ideaExplanation">üìö Explicaci√≥n cient√≠fica (el "por qu√©")*</label>
                        <textarea id="ideaExplanation" placeholder="Ej: Sacrifican estos org√°nulos durante su maduraci√≥n para maximizar el espacio disponible para hemoglobina y transportar m√°s ox√≠geno." required maxlength="800"></textarea>
                        <div class="char-counter"><span id="explanationCounter">0</span>/800</div>
                    </div>

                    <div class="form-group">
                        <label for="ideaReference">üìñ Referencia acad√©mica (formato completo)*</label>
                        <textarea id="ideaReference" placeholder="Ej: Mel HC, Yee JP. Blood cell stiffness and filterability. Blood Cells. 1975;1(3):653-64." required maxlength="500"></textarea>
                        <div class="char-counter"><span id="referenceCounter">0</span>/500</div>
                    </div>

                    <div class="form-group">
                        <label for="ideaQuestion">üí¨ Pregunta para engagement (redes sociales)</label>
                        <textarea id="ideaQuestion" placeholder="Ej: ¬øSab√≠as esto sobre los gl√≥bulos rojos? üî¥ ¬øQu√© otra c√©lula conoces con caracter√≠sticas √∫nicas?" maxlength="500"></textarea>
                        <div class="char-counter"><span id="questionCounter">0</span>/500</div>
                    </div>
                </div>

                <!-- Secci√≥n de Imagen -->
                <div class="image-section">
                    <h3>üé® Imagen Hiperrealista (opcional)</h3>

                    <div class="form-group">
                        <label for="imagePrompt">Prompt para generar imagen</label>
                        <textarea id="imagePrompt" placeholder="Ej: Photorealistic 8K scientific illustration of red blood cells without nucleus, cross-section view showing hemoglobin molecules, medical textbook quality, Nature magazine style..." maxlength="800"></textarea>
                        <div class="char-counter"><span id="promptCounter">0</span>/800</div>
                    </div>

                    <div class="form-group">
                        <label for="imageUrl">URL de la imagen generada</label>
                        <input type="url" id="imageUrl" placeholder="https://...">
                    </div>

                    <div class="form-group">
                        <label for="imageNotes">Notas sobre la imagen</label>
                        <textarea id="imageNotes" placeholder="Herramienta: DALL-E 3, Midjourney v6, etc. Ajustes realizados..." maxlength="300"></textarea>
                        <div class="char-counter"><span id="imageNotesCounter">0</span>/300</div>
                    </div>
                </div>

                <div class="btn-container">
                    <button type="submit" class="btn btn-primary">üíæ Guardar Idea</button>
                    <button type="button" class="btn btn-secondary" onclick="clearForm()">üîÑ Limpiar</button>
                </div>
            </form>
        </div>

        <div class="filters">
            <span class="filter-label">Filtrar:</span>
            <select class="filter-select" id="filterCategory" onchange="filterIdeas()">
                <option value="all">Todas las categor√≠as</option>
                <option value="celular">Biol. Celular/Molecular</option>
                <option value="genetica">Gen√©tica</option>
                <option value="metabolismo">Metabolismo</option>
                <option value="inmunologia">Inmunolog√≠a</option>
                <option value="neurociencia">Neurociencia</option>
                <option value="nutricion">Nutrici√≥n</option>
                <option value="general">General</option>
            </select>
            <select class="filter-select" id="filterStatus" onchange="filterIdeas()">
                <option value="all">Todas</option>
                <option value="pending">Pendientes</option>
                <option value="completed">Publicadas</option>
            </select>
            <input type="text" class="search-box" id="searchBox" placeholder="üîç Buscar ideas..." oninput="filterIdeas()">
        </div>

        <div class="ideas-container" id="ideasContainer"></div>
    </div>

    <div class="toast" id="toast">
        <span id="toastMessage"></span>
    </div>

    <div class="modal" id="deleteModal">
        <div class="modal-content">
            <div class="modal-header">‚ö†Ô∏è Confirmar Eliminaci√≥n</div>
            <p style="color: #4a5568; margin-bottom: 20px;">¬øEst√°s seguro de que quieres eliminar esta idea? Esta acci√≥n no se puede deshacer.</p>
            <div class="btn-container">
                <button class="btn btn-primary" onclick="confirmDelete()">Eliminar</button>
                <button class="btn btn-secondary" onclick="closeDeleteModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <script>
        let ideas = [];
        let editingId = null;
        let deleteId = null;

        function loadIdeas() {
            const stored = localStorage.getItem('sabiasQueIdeas');
            if (stored) {
                ideas = JSON.parse(stored);
            }
            renderIdeas();
            updateStats();
        }

        function saveIdeas() {
            localStorage.setItem('sabiasQueIdeas', JSON.stringify(ideas));
            updateStats();
        }

        // Contadores
        ['ideaTitle', 'ideaExplanation', 'ideaReference', 'ideaQuestion', 'imagePrompt', 'imageNotes'].forEach(id => {
            const elem = document.getElementById(id);
            const counterId = id.replace('idea', '').replace('image', '').toLowerCase() + 'Counter';
            if (counterId === 'titleCounter') {
                elem.addEventListener('input', e => document.getElementById('titleCounter').textContent = e.target.value.length);
            } else if (counterId === 'explanationCounter') {
                elem.addEventListener('input', e => document.getElementById('explanationCounter').textContent = e.target.value.length);
            } else if (counterId === 'referenceCounter') {
                elem.addEventListener('input', e => document.getElementById('referenceCounter').textContent = e.target.value.length);
            } else if (counterId === 'questionCounter') {
                elem.addEventListener('input', e => document.getElementById('questionCounter').textContent = e.target.value.length);
            } else if (counterId === 'promptCounter') {
                elem.addEventListener('input', e => document.getElementById('promptCounter').textContent = e.target.value.length);
            } else if (counterId === 'notesCounter') {
                elem.addEventListener('input', e => document.getElementById('imageNotesCounter').textContent = e.target.value.length);
            }
        });

        document.getElementById('ideaForm').addEventListener('submit', e => {
            e.preventDefault();

            const newIdea = {
                id: editingId || Date.now(),
                title: document.getElementById('ideaTitle').value,
                category: document.getElementById('ideaCategory').value,
                explanation: document.getElementById('ideaExplanation').value,
                reference: document.getElementById('ideaReference').value,
                question: document.getElementById('ideaQuestion').value,
                imagePrompt: document.getElementById('imagePrompt').value,
                imageUrl: document.getElementById('imageUrl').value,
                imageNotes: document.getElementById('imageNotes').value,
                completed: false,
                createdAt: editingId ? ideas.find(i => i.id === editingId).createdAt : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            if (editingId) {
                const index = ideas.findIndex(i => i.id === editingId);
                newIdea.completed = ideas[index].completed;
                ideas[index] = newIdea;
                showToast('‚úÖ Idea actualizada');
                editingId = null;
            } else {
                ideas.unshift(newIdea);
                showToast('‚úÖ Idea guardada');
            }

            saveIdeas();
            renderIdeas();
            clearForm();
        });

        function clearForm() {
            document.getElementById('ideaForm').reset();
            ['titleCounter', 'explanationCounter', 'referenceCounter', 'questionCounter', 'promptCounter', 'imageNotesCounter'].forEach(id => {
                document.getElementById(id).textContent = '0';
            });
            editingId = null;
        }

        function renderIdeas() {
            const container = document.getElementById('ideasContainer');
            const filterCat = document.getElementById('filterCategory').value;
            const filterStat = document.getElementById('filterStatus').value;
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();

            let filtered = ideas.filter(idea => {
                const matchCategory = filterCat === 'all' || idea.category === filterCat;
                const matchStatus = filterStat === 'all' || 
                    (filterStat === 'completed' && idea.completed) ||
                    (filterStat === 'pending' && !idea.completed);
                const matchSearch = idea.title.toLowerCase().includes(searchTerm) ||
                    (idea.explanation && idea.explanation.toLowerCase().includes(searchTerm)) ||
                    (idea.reference && idea.reference.toLowerCase().includes(searchTerm));
                return matchCategory && matchStatus && matchSearch;
            });

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üí°</div>
                        <h3>No hay ideas aqu√≠</h3>
                        <p>Agrega tu primera idea cient√≠fica</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filtered.map(idea => `
                <div class="idea-card ${idea.completed ? 'completed' : ''}">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" ${idea.completed ? 'checked' : ''} 
                            onchange="toggleComplete(${idea.id})">
                    </div>
                    <div class="idea-content">
                        <div class="idea-header">
                            <span class="idea-category cat-${idea.category}">${getCategoryName(idea.category)}</span>
                        </div>
                        <div class="idea-title">${idea.title}</div>
                        <div class="idea-explanation">
                            <strong>üìö Explicaci√≥n:</strong> ${idea.explanation}
                        </div>
                        <div class="idea-reference">
                            <strong>üìñ Referencia:</strong> ${idea.reference}
                        </div>
                        ${idea.question ? `<div class="idea-question">üí¨ ${idea.question}</div>` : ''}
                        
                        ${(idea.imagePrompt || idea.imageUrl || idea.imageNotes) ? `
                            <div class="idea-image-section">
                                <h4>üé® Imagen</h4>
                                ${idea.imageUrl ? `
                                    <div class="idea-image-url">üîó <a href="${idea.imageUrl}" target="_blank">Ver imagen</a></div>
                                    <img src="${idea.imageUrl}" alt="Imagen" class="idea-image-preview" loading="lazy">
                                ` : ''}
                                ${idea.imagePrompt ? `
                                    <div style="margin-top: 10px;">
                                        <strong style="font-size: 12px;">Prompt:</strong>
                                        <div class="idea-prompt">${idea.imagePrompt}</div>
                                    </div>
                                ` : ''}
                                ${idea.imageNotes ? `<div style="font-size: 12px; color: #065f46; margin-top: 8px;">üí¨ ${idea.imageNotes}</div>` : ''}
                            </div>
                        ` : ''}
                        
                        <div class="idea-meta">
                            <span>üìÖ ${formatDate(idea.createdAt)}</span>
                            ${idea.completed ? '<span>‚úÖ Publicada</span>' : '<span>‚è≥ Pendiente</span>'}
                        </div>
                    </div>
                    <div class="idea-actions">
                        <button class="btn-icon btn-edit" onclick="editIdea(${idea.id})">‚úèÔ∏è</button>
                        <button class="btn-icon btn-delete" onclick="openDeleteModal(${idea.id})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        function toggleComplete(id) {
            const idea = ideas.find(i => i.id === id);
            idea.completed = !idea.completed;
            idea.updatedAt = new Date().toISOString();
            saveIdeas();
            renderIdeas();
            showToast(idea.completed ? '‚úÖ Publicada' : '‚è≥ Pendiente');
        }

        function editIdea(id) {
            const idea = ideas.find(i => i.id === id);
            editingId = id;
            document.getElementById('ideaTitle').value = idea.title;
            document.getElementById('ideaCategory').value = idea.category;
            document.getElementById('ideaExplanation').value = idea.explanation;
            document.getElementById('ideaReference').value = idea.reference;
            document.getElementById('ideaQuestion').value = idea.question || '';
            document.getElementById('imagePrompt').value = idea.imagePrompt || '';
            document.getElementById('imageUrl').value = idea.imageUrl || '';
            document.getElementById('imageNotes').value = idea.imageNotes || '';
            
            document.getElementById('titleCounter').textContent = idea.title.length;
            document.getElementById('explanationCounter').textContent = idea.explanation.length;
            document.getElementById('referenceCounter').textContent = idea.reference.length;
            document.getElementById('questionCounter').textContent = (idea.question || '').length;
            document.getElementById('promptCounter').textContent = (idea.imagePrompt || '').length;
            document.getElementById('imageNotesCounter').textContent = (idea.imageNotes || '').length;

            window.scrollTo({ top: 0, behavior: 'smooth' });
            showToast('‚úèÔ∏è Editando...');
        }

        function openDeleteModal(id) {
            deleteId = id;
            document.getElementById('deleteModal').classList.add('show');
        }

        function closeDeleteModal() {
            deleteId = null;
            document.getElementById('deleteModal').classList.remove('show');
        }

        function confirmDelete() {
            ideas = ideas.filter(i => i.id !== deleteId);
            saveIdeas();
            renderIdeas();
            closeDeleteModal();
            showToast('üóëÔ∏è Eliminada');
        }

        function filterIdeas() {
            renderIdeas();
        }

        function updateStats() {
            const total = ideas.length;
            const completed = ideas.filter(i => i.completed).length;
            const pending = total - completed;
            const progress = total > 0 ? Math.round((completed / total) * 100) : 0;

            document.getElementById('totalIdeas').textContent = total;
            document.getElementById('completedIdeas').textContent = completed;
            document.getElementById('pendingIdeas').textContent = pending;
            document.getElementById('progressPercent').textContent = progress + '%';
        }

        function getCategoryName(cat) {
            const names = {
                celular: 'Biol. Celular/Molecular',
                genetica: 'Gen√©tica',
                metabolismo: 'Metabolismo',
                inmunologia: 'Inmunolog√≠a',
                neurociencia: 'Neurociencia',
                nutricion: 'Nutrici√≥n',
                general: 'General'
            };
            return names[cat] || cat;
        }

        function formatDate(isoDate) {
            const date = new Date(isoDate);
            return date.toLocaleDateString('es-MX', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            });
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        loadIdeas();
    </script>
</body>
</html>